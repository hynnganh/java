{"ast":null,"code":"// Trong ProductCart.js - sửa lại loadCart function\nconst loadCart = async () => {\n  try {\n    setLoading(true);\n\n    // Lấy cartId từ đâu đó (có thể lưu trong localStorage hoặc từ user context)\n    const userCart = JSON.parse(localStorage.getItem('userCart')) || {};\n    const cartId = userCart.cartId;\n    if (!cartId) {\n      // Nếu chưa có cartId, tạo giỏ hàng mới hoặc lấy cart active\n      const activeCart = await cartService.getOrCreateActiveCart(currentUser.email);\n      setCart(activeCart);\n\n      // Lưu cartId vào localStorage để sử dụng sau\n      if (activeCart && activeCart.id) {\n        localStorage.setItem('userCart', JSON.stringify({\n          cartId: activeCart.id,\n          email: currentUser.email\n        }));\n      }\n    } else {\n      // Đã có cartId, lấy thông tin giỏ hàng\n      const cartData = await cartService.getCart(currentUser.email, cartId);\n      setCart(cartData);\n    }\n  } catch (error) {\n    console.error('Error loading cart:', error);\n    showToast('❌ Lỗi khi tải giỏ hàng', 'error');\n  } finally {\n    setLoading(false);\n  }\n};","map":{"version":3,"names":["loadCart","setLoading","userCart","JSON","parse","localStorage","getItem","cartId","activeCart","cartService","getOrCreateActiveCart","currentUser","email","setCart","id","setItem","stringify","cartData","getCart","error","console","showToast"],"sources":["D:/JVA/frontend/src/services/cartService.js"],"sourcesContent":["// Trong ProductCart.js - sửa lại loadCart function\nconst loadCart = async () => {\n  try {\n    setLoading(true);\n    \n    // Lấy cartId từ đâu đó (có thể lưu trong localStorage hoặc từ user context)\n    const userCart = JSON.parse(localStorage.getItem('userCart')) || {};\n    const cartId = userCart.cartId;\n    \n    if (!cartId) {\n      // Nếu chưa có cartId, tạo giỏ hàng mới hoặc lấy cart active\n      const activeCart = await cartService.getOrCreateActiveCart(currentUser.email);\n      setCart(activeCart);\n      \n      // Lưu cartId vào localStorage để sử dụng sau\n      if (activeCart && activeCart.id) {\n        localStorage.setItem('userCart', JSON.stringify({ \n          cartId: activeCart.id,\n          email: currentUser.email \n        }));\n      }\n    } else {\n      // Đã có cartId, lấy thông tin giỏ hàng\n      const cartData = await cartService.getCart(currentUser.email, cartId);\n      setCart(cartData);\n    }\n    \n  } catch (error) {\n    console.error('Error loading cart:', error);\n    showToast('❌ Lỗi khi tải giỏ hàng', 'error');\n  } finally {\n    setLoading(false);\n  }\n};"],"mappings":"AAAA;AACA,MAAMA,QAAQ,GAAG,MAAAA,CAAA,KAAY;EAC3B,IAAI;IACFC,UAAU,CAAC,IAAI,CAAC;;IAEhB;IACA,MAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,CAAC;IACnE,MAAMC,MAAM,GAAGL,QAAQ,CAACK,MAAM;IAE9B,IAAI,CAACA,MAAM,EAAE;MACX;MACA,MAAMC,UAAU,GAAG,MAAMC,WAAW,CAACC,qBAAqB,CAACC,WAAW,CAACC,KAAK,CAAC;MAC7EC,OAAO,CAACL,UAAU,CAAC;;MAEnB;MACA,IAAIA,UAAU,IAAIA,UAAU,CAACM,EAAE,EAAE;QAC/BT,YAAY,CAACU,OAAO,CAAC,UAAU,EAAEZ,IAAI,CAACa,SAAS,CAAC;UAC9CT,MAAM,EAAEC,UAAU,CAACM,EAAE;UACrBF,KAAK,EAAED,WAAW,CAACC;QACrB,CAAC,CAAC,CAAC;MACL;IACF,CAAC,MAAM;MACL;MACA,MAAMK,QAAQ,GAAG,MAAMR,WAAW,CAACS,OAAO,CAACP,WAAW,CAACC,KAAK,EAAEL,MAAM,CAAC;MACrEM,OAAO,CAACI,QAAQ,CAAC;IACnB;EAEF,CAAC,CAAC,OAAOE,KAAK,EAAE;IACdC,OAAO,CAACD,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;IAC3CE,SAAS,CAAC,wBAAwB,EAAE,OAAO,CAAC;EAC9C,CAAC,SAAS;IACRpB,UAAU,CAAC,KAAK,CAAC;EACnB;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}