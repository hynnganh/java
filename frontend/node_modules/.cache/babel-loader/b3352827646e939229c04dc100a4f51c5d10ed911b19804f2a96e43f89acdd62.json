{"ast":null,"code":"var _jsxFileName = \"E:\\\\Java\\\\DoAn\\\\frontend\\\\src\\\\pages\\\\product\\\\ProductDetail.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport Swal from 'sweetalert2';\nimport api from \"../../services/api\";\nimport cartService from \"../../services/cartService\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProductDetail = () => {\n  _s();\n  var _product$specialPrice;\n  const {\n    productId\n  } = useParams();\n  const navigate = useNavigate();\n  const [product, setProduct] = useState(null);\n  const [addingToCart, setAddingToCart] = useState(false);\n\n  // L·∫•y User t·ª´ LocalStorage (ƒë∆∞·ª£c l∆∞u sau khi Login th√†nh c√¥ng)\n  const currentUser = JSON.parse(localStorage.getItem('user'));\n  useEffect(() => {\n    api.get(`/public/products/${productId}`).then(res => setProduct(res.data));\n  }, [productId]);\n  const handleAddToCart = async () => {\n    // 1. Ki·ªÉm tra ƒêƒÉng nh·∫≠p\n    if (!currentUser) {\n      return Swal.fire({\n        title: 'B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p',\n        text: \"Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ mua s·∫Øm!\",\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonText: 'ƒêƒÉng nh·∫≠p'\n      }).then(res => res.isConfirmed && navigate('/login'));\n    }\n\n    // 2. L·∫•y CartId (Gi·∫£ ƒë·ªãnh cartId ƒë∆∞·ª£c backend tr·∫£ v·ªÅ l√∫c login)\n    const cartId = currentUser.cartId;\n    if (!cartId) return Swal.fire('L·ªói', 'Kh√¥ng t√¨m th·∫•y gi·ªè h√†ng c·ªßa b·∫°n', 'error');\n    try {\n      setAddingToCart(true);\n      // G·ªçi ƒë√∫ng Endpoint Backend: /public/carts/{cartId}/products/{productId}/quantity/{quantity}\n      await cartService.addToCart(cartId, productId, 1);\n      Swal.fire({\n        icon: 'success',\n        title: 'ƒê√£ th√™m v√†o gi·ªè!',\n        showConfirmButton: false,\n        timer: 1000\n      });\n\n      // ƒê·ªìng b·ªô s·ªë l∆∞·ª£ng icon gi·ªè h√†ng ·ªü Header\n      window.dispatchEvent(new Event('cartUpdated'));\n    } catch (err) {\n      var _err$response, _err$response$data;\n      Swal.fire('Th·∫•t b·∫°i', ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'C√≥ l·ªói x·∫£y ra', 'error');\n    } finally {\n      setAddingToCart(false);\n    }\n  };\n  if (!product) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"text-center p-5\",\n    children: \"\\u0110ang t\\u1EA3i...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 24\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container py-5\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-6\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: `http://localhost:8080/api/public/products/image/${product.image}`,\n          className: \"img-fluid rounded shadow-sm\",\n          alt: product.productName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-md-6\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"fw-bold\",\n          children: product.productName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-danger my-3\",\n          children: [(_product$specialPrice = product.specialPrice) === null || _product$specialPrice === void 0 ? void 0 : _product$specialPrice.toLocaleString(), \" \\u20AB\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-muted\",\n          children: product.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-primary btn-lg px-5 mt-4\",\n          onClick: handleAddToCart,\n          disabled: addingToCart || product.quantity <= 0,\n          children: addingToCart ? 'ƒêang th√™m...' : 'üõí Th√™m v√†o gi·ªè h√†ng'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 65,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n};\n_s(ProductDetail, \"Evdq0zFkE3/RPGU+2JP/aaa03No=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = ProductDetail;\nexport default ProductDetail;\nvar _c;\n$RefreshReg$(_c, \"ProductDetail\");","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","Swal","api","cartService","jsxDEV","_jsxDEV","ProductDetail","_s","_product$specialPrice","productId","navigate","product","setProduct","addingToCart","setAddingToCart","currentUser","JSON","parse","localStorage","getItem","get","then","res","data","handleAddToCart","fire","title","text","icon","showCancelButton","confirmButtonText","isConfirmed","cartId","addToCart","showConfirmButton","timer","window","dispatchEvent","Event","err","_err$response","_err$response$data","response","message","className","children","fileName","_jsxFileName","lineNumber","columnNumber","src","image","alt","productName","specialPrice","toLocaleString","description","onClick","disabled","quantity","_c","$RefreshReg$"],"sources":["E:/Java/DoAn/frontend/src/pages/product/ProductDetail.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport Swal from 'sweetalert2';\nimport api from \"../../services/api\";\nimport cartService from \"../../services/cartService\";\n\nconst ProductDetail = () => {\n  const { productId } = useParams();\n  const navigate = useNavigate();\n  const [product, setProduct] = useState(null);\n  const [addingToCart, setAddingToCart] = useState(false);\n\n  // L·∫•y User t·ª´ LocalStorage (ƒë∆∞·ª£c l∆∞u sau khi Login th√†nh c√¥ng)\n  const currentUser = JSON.parse(localStorage.getItem('user'));\n\n  useEffect(() => {\n    api.get(`/public/products/${productId}`).then(res => setProduct(res.data));\n  }, [productId]);\n\n  const handleAddToCart = async () => {\n    // 1. Ki·ªÉm tra ƒêƒÉng nh·∫≠p\n    if (!currentUser) {\n      return Swal.fire({\n        title: 'B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p',\n        text: \"Vui l√≤ng ƒëƒÉng nh·∫≠p ƒë·ªÉ mua s·∫Øm!\",\n        icon: 'warning',\n        showCancelButton: true,\n        confirmButtonText: 'ƒêƒÉng nh·∫≠p'\n      }).then(res => res.isConfirmed && navigate('/login'));\n    }\n\n    // 2. L·∫•y CartId (Gi·∫£ ƒë·ªãnh cartId ƒë∆∞·ª£c backend tr·∫£ v·ªÅ l√∫c login)\n    const cartId = currentUser.cartId; \n    \n    if (!cartId) return Swal.fire('L·ªói', 'Kh√¥ng t√¨m th·∫•y gi·ªè h√†ng c·ªßa b·∫°n', 'error');\n\n    try {\n      setAddingToCart(true);\n      // G·ªçi ƒë√∫ng Endpoint Backend: /public/carts/{cartId}/products/{productId}/quantity/{quantity}\n      await cartService.addToCart(cartId, productId, 1);\n\n      Swal.fire({ icon: 'success', title: 'ƒê√£ th√™m v√†o gi·ªè!', showConfirmButton: false, timer: 1000 });\n      \n      // ƒê·ªìng b·ªô s·ªë l∆∞·ª£ng icon gi·ªè h√†ng ·ªü Header\n      window.dispatchEvent(new Event('cartUpdated'));\n    } catch (err) {\n      Swal.fire('Th·∫•t b·∫°i', err.response?.data?.message || 'C√≥ l·ªói x·∫£y ra', 'error');\n    } finally {\n      setAddingToCart(false);\n    }\n  };\n\n  if (!product) return <div className=\"text-center p-5\">ƒêang t·∫£i...</div>;\n\n  return (\n    <div className=\"container py-5\">\n      <div className=\"row\">\n        <div className=\"col-md-6\">\n          <img src={`http://localhost:8080/api/public/products/image/${product.image}`} className=\"img-fluid rounded shadow-sm\" alt={product.productName} />\n        </div>\n        <div className=\"col-md-6\">\n          <h2 className=\"fw-bold\">{product.productName}</h2>\n          <h3 className=\"text-danger my-3\">{product.specialPrice?.toLocaleString()} ‚Ç´</h3>\n          <p className=\"text-muted\">{product.description}</p>\n          <button \n            className=\"btn btn-primary btn-lg px-5 mt-4\" \n            onClick={handleAddToCart}\n            disabled={addingToCart || product.quantity <= 0}\n          >\n            {addingToCart ? 'ƒêang th√™m...' : 'üõí Th√™m v√†o gi·ªè h√†ng'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ProductDetail;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}