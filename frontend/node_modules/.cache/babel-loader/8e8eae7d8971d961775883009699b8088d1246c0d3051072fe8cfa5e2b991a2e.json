{"ast":null,"code":"import api from './api';\nconst cartService = {\n  // ========== CART CREATION & MANAGEMENT ==========\n\n  // T·∫°o gi·ªè h√†ng m·ªõi - ƒê√É C√ì ENDPOINT\n  createCart: async emailId => {\n    try {\n      console.log(\"üÜï ƒêang t·∫°o gi·ªè h√†ng m·ªõi cho:\", emailId);\n\n      // ‚ùå REMOVE: Kh√¥ng t·∫°o cart t·∫°m trong localStorage n·ªØa\n      // ‚úÖ CH·ªà g·ªçi API ƒë·ªÉ server t·∫°o cart\n\n      const response = await api.post(`/public/users/${emailId}/carts`);\n      console.log(\"‚úÖ ƒê√£ t·∫°o gi·ªè h√†ng t·ª´ server:\", response.data);\n      const newCart = response.data;\n\n      // C·∫≠p nh·∫≠t user trong localStorage v·ªõi cartId t·ª´ SERVER\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n      user.cart = {\n        cartId: newCart.cartId\n      };\n      localStorage.setItem('user', JSON.stringify(user));\n\n      // C·∫≠p nh·∫≠t cart trong localStorage\n      cartService.updateCartInStorage(newCart);\n      return newCart;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi t·∫°o gi·ªè h√†ng:', error);\n\n      // ‚ùå KH√îNG t·∫°o cart t·∫°m - s·∫Ω g√¢y l·ªói 404\n      throw new Error('Kh√¥ng th·ªÉ t·∫°o gi·ªè h√†ng. Vui l√≤ng th·ª≠ l·∫°i.');\n    }\n  },\n  // L·∫•y gi·ªè h√†ng active - FIX L·ªñI\n  getActiveCart: async emailId => {\n    try {\n      var _user$cart;\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n      let cartId = (_user$cart = user.cart) === null || _user$cart === void 0 ? void 0 : _user$cart.cartId;\n      console.log(\"üîç T√¨m cartId:\", {\n        emailId,\n        cartId\n      });\n\n      // Ki·ªÉm tra user ƒëƒÉng nh·∫≠p\n      if (!emailId || emailId === 'guest@example.com') {\n        console.log(\"üë§ User ch∆∞a ƒëƒÉng nh·∫≠p\");\n        return {\n          cartId: null,\n          products: [],\n          totalPrice: 0\n        };\n      }\n\n      // N·∫øu c√≥ cartId, th·ª≠ l·∫•y t·ª´ server\n      if (cartId) {\n        try {\n          console.log(\"üì¶ Th·ª≠ l·∫•y gi·ªè h√†ng t·ª´ server v·ªõi cartId:\", cartId);\n          const cart = await cartService.getCart(emailId, cartId);\n          console.log(\"‚úÖ L·∫•y gi·ªè h√†ng t·ª´ server th√†nh c√¥ng\");\n          return cart;\n        } catch (serverError) {\n          var _serverError$response;\n          console.warn(\"‚ö†Ô∏è Kh√¥ng l·∫•y ƒë∆∞·ª£c cart t·ª´ server:\", serverError.message);\n\n          // N·∫øu l·ªói 404, cart kh√¥ng t·ªìn t·∫°i -> t·∫°o m·ªõi\n          if (((_serverError$response = serverError.response) === null || _serverError$response === void 0 ? void 0 : _serverError$response.status) === 404) {\n            console.log(\"üÜï Cart kh√¥ng t·ªìn t·∫°i tr√™n server, ƒëang t·∫°o m·ªõi...\");\n            return await cartService.createCart(emailId);\n          }\n          throw serverError;\n        }\n      }\n\n      // N·∫øu kh√¥ng c√≥ cartId, t·∫°o m·ªõi\n      console.log(\"üÜï Ch∆∞a c√≥ cartId, ƒëang t·∫°o gi·ªè h√†ng m·ªõi...\");\n      return await cartService.createCart(emailId);\n    } catch (error) {\n      console.error('‚ùå L·ªói khi l·∫•y gi·ªè h√†ng active:', error);\n      throw error;\n    }\n  },\n  // Th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng - FIX L·ªñI\n  addToCart: async (cartId, productId, quantity = 1) => {\n    try {\n      console.log(`üõí Th√™m s·∫£n ph·∫©m ${productId} (s·ªë l∆∞·ª£ng: ${quantity}) v√†o gi·ªè ${cartId}`);\n\n      // ‚úÖ KI·ªÇM TRA cartId c√≥ h·ª£p l·ªá kh√¥ng\n      if (!cartId) {\n        throw new Error('CartId kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng');\n      }\n\n      // ‚úÖ ƒê·∫¢M B·∫¢O cartId l√† s·ªë v√† h·ª£p l·ªá\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId) || numericCartId <= 0) {\n        throw new Error(`CartId kh√¥ng h·ª£p l·ªá: ${cartId}`);\n      }\n      console.log(`üîß G·ªçi API: /public/carts/${numericCartId}/products/${productId}/quantity/${quantity}`);\n      const response = await api.post(`/public/carts/${numericCartId}/products/${productId}/quantity/${quantity}`);\n      console.log(\"‚úÖ Th√™m v√†o gi·ªè h√†ng th√†nh c√¥ng:\", response.data);\n      return response.data;\n    } catch (error) {\n      var _error$response, _error$response2;\n      console.error('‚ùå L·ªói khi th√™m v√†o gi·ªè h√†ng:', error);\n\n      // ‚úÖ PH√ÇN T√çCH L·ªñI CHI TI·∫æT\n      if (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 404) {\n        throw new Error(`Kh√¥ng t√¨m th·∫•y gi·ªè h√†ng (ID: ${cartId}). Vui l√≤ng th·ª≠ l·∫°i.`);\n      } else if (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 400) {\n        var _error$response$data;\n        throw new Error(`S·∫£n ph·∫©m kh√¥ng h·ª£p l·ªá ho·∫∑c ƒë√£ c√≥ trong gi·ªè h√†ng: ${((_error$response$data = error.response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || ''}`);\n      }\n      throw error;\n    }\n  },\n  // L·∫•y gi·ªè h√†ng theo email v√† cartId\n  getCart: async (emailId, cartId) => {\n    try {\n      const response = await api.get(`/public/users/${emailId}/carts/${cartId}`);\n      return response.data;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi l·∫•y gi·ªè h√†ng:', error);\n      throw error;\n    }\n  },\n  // Th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng\n  addToCart: async (cartId, productId, quantity = 1) => {\n    try {\n      console.log(`üõí Th√™m s·∫£n ph·∫©m ${productId} (s·ªë l∆∞·ª£ng: ${quantity}) v√†o gi·ªè ${cartId}`);\n      if (!cartId) {\n        throw new Error('CartId kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng');\n      }\n      const response = await api.post(`/public/carts/${cartId}/products/${productId}/quantity/${quantity}`);\n      console.log(\"‚úÖ Th√™m v√†o gi·ªè h√†ng th√†nh c√¥ng:\", response.data);\n\n      // C·∫≠p nh·∫≠t localStorage v·ªõi d·ªØ li·ªáu m·ªõi\n      cartService.updateCartInStorage(response.data);\n      return response.data;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi th√™m v√†o gi·ªè h√†ng:', error);\n      throw error;\n    }\n  },\n  // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng s·∫£n ph·∫©m\n  updateQuantity: async (cartId, productId, quantity) => {\n    try {\n      console.log(`üîÑ C·∫≠p nh·∫≠t s·∫£n ph·∫©m ${productId} th√†nh s·ªë l∆∞·ª£ng: ${quantity}`);\n      if (!cartId) {\n        throw new Error('CartId kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng');\n      }\n      const response = await api.put(`/public/carts/${cartId}/products/${productId}/quantity/${quantity}`);\n      console.log(\"‚úÖ C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng th√†nh c√¥ng:\", response.data);\n\n      // C·∫≠p nh·∫≠t localStorage\n      cartService.updateCartInStorage(response.data);\n      return response.data;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi c·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng:', error);\n      throw error;\n    }\n  },\n  // X√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè h√†ng\n  removeFromCart: async (cartId, productId) => {\n    try {\n      console.log(`üóëÔ∏è X√≥a s·∫£n ph·∫©m ${productId} kh·ªèi gi·ªè ${cartId}`);\n      if (!cartId) {\n        throw new Error('CartId kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng');\n      }\n      const response = await api.delete(`/public/carts/${cartId}/products/${productId}`);\n      console.log(\"‚úÖ X√≥a s·∫£n ph·∫©m th√†nh c√¥ng:\", response.data);\n\n      // C·∫ßn l·∫•y l·∫°i gi·ªè h√†ng sau khi x√≥a ƒë·ªÉ c√≥ d·ªØ li·ªáu m·ªõi nh·∫•t\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n      if (user.email) {\n        const updatedCart = await cartService.getCart(user.email, cartId);\n        cartService.updateCartInStorage(updatedCart);\n        return updatedCart;\n      }\n      return response.data;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi x√≥a s·∫£n ph·∫©m:', error);\n      throw error;\n    }\n  },\n  // L√†m r·ªóng gi·ªè h√†ng (x√≥a t·∫•t c·∫£ s·∫£n ph·∫©m)\n  clearCart: async (emailId, cartId) => {\n    try {\n      console.log(`üßπ L√†m r·ªóng gi·ªè h√†ng ${cartId}`);\n      if (!cartId) {\n        throw new Error('CartId kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng');\n      }\n\n      // L·∫•y danh s√°ch s·∫£n ph·∫©m trong gi·ªè\n      const cart = await cartService.getCart(emailId, cartId);\n      if (!cart.products || cart.products.length === 0) {\n        return {\n          success: true,\n          message: 'Gi·ªè h√†ng ƒë√£ tr·ªëng'\n        };\n      }\n\n      // X√≥a t·ª´ng s·∫£n ph·∫©m\n      const deletePromises = cart.products.map(product => cartService.removeFromCart(cartId, product.productId));\n      await Promise.all(deletePromises);\n      console.log('‚úÖ ƒê√£ l√†m r·ªóng gi·ªè h√†ng th√†nh c√¥ng');\n\n      // C·∫≠p nh·∫≠t localStorage v·ªõi gi·ªè h√†ng r·ªóng\n      const emptyCart = {\n        cartId: cartId,\n        products: [],\n        totalPrice: 0\n      };\n      cartService.updateCartInStorage(emptyCart);\n      return {\n        success: true,\n        message: 'ƒê√£ l√†m r·ªóng gi·ªè h√†ng'\n      };\n    } catch (error) {\n      console.error('‚ùå L·ªói khi l√†m r·ªóng gi·ªè h√†ng:', error);\n      throw error;\n    }\n  },\n  // ========== ORDER MANAGEMENT ==========\n\n  // T·∫°o ƒë∆°n h√†ng\n  createOrder: async (emailId, cartId, paymentMethod) => {\n    try {\n      console.log('üõí T·∫°o ƒë∆°n h√†ng v·ªõi:', {\n        emailId,\n        cartId,\n        paymentMethod\n      });\n\n      // Validate d·ªØ li·ªáu\n      if (!emailId || !cartId || !paymentMethod) {\n        throw new Error('Thi·∫øu th√¥ng tin b·∫Øt bu·ªôc: email, cartId, paymentMethod');\n      }\n      const response = await api.post(`/public/users/${emailId}/carts/${cartId}/payments/${paymentMethod}/order`);\n      console.log('‚úÖ T·∫°o ƒë∆°n h√†ng th√†nh c√¥ng:', response.data);\n      return response.data;\n    } catch (error) {\n      var _error$response3, _error$response4, _error$response5;\n      console.error('‚ùå L·ªói khi t·∫°o ƒë∆°n h√†ng:', error);\n      let errorMessage = 'L·ªói khi t·∫°o ƒë∆°n h√†ng';\n      if (((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.status) === 400) {\n        var _error$response$data2;\n        errorMessage = ((_error$response$data2 = error.response.data) === null || _error$response$data2 === void 0 ? void 0 : _error$response$data2.message) || 'D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá';\n      } else if (((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.status) === 404) {\n        errorMessage = 'Kh√¥ng t√¨m th·∫•y gi·ªè h√†ng ho·∫∑c ng∆∞·ªùi d√πng';\n      } else if (((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : _error$response5.status) === 500) {\n        errorMessage = 'L·ªói server, vui l√≤ng th·ª≠ l·∫°i sau';\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      throw new Error(errorMessage);\n    }\n  },\n  // ========== UTILITY FUNCTIONS ==========\n\n  // T√≠nh t·ªïng ti·ªÅn gi·ªè h√†ng\n  calculateTotal: cartItems => {\n    if (!cartItems || cartItems.length === 0) return 0;\n    return cartItems.reduce((total, item) => {\n      const price = item.specialPrice !== undefined && item.specialPrice !== null ? item.specialPrice : item.price || 0;\n      const quantity = item.quantity || 1;\n      return total + price * quantity;\n    }, 0);\n  },\n  // ƒê·∫øm t·ªïng s·ªë s·∫£n ph·∫©m\n  getTotalItems: cartItems => {\n    if (!cartItems || cartItems.length === 0) return 0;\n    return cartItems.reduce((total, item) => total + (item.quantity || 1), 0);\n  },\n  // Format gi√° ti·ªÅn\n  formatPrice: price => {\n    return (Number(price) || 0).toLocaleString('vi-VN', {\n      style: 'currency',\n      currency: 'VND'\n    });\n  },\n  // L·∫•y s·ªë l∆∞·ª£ng s·∫£n ph·∫©m trong gi·ªè (cho badge)\n  getCartCount: async emailId => {\n    try {\n      // ∆Øu ti√™n l·∫•y t·ª´ localStorage tr∆∞·ªõc (nhanh)\n      const localCount = cartService.getCartCountFromStorage();\n      if (localCount > 0) {\n        return localCount;\n      }\n\n      // N·∫øu c√≥ user ƒëƒÉng nh·∫≠p, th·ª≠ l·∫•y t·ª´ server\n      if (emailId && emailId !== 'guest@example.com') {\n        try {\n          var _user$cart2;\n          const user = JSON.parse(localStorage.getItem('user') || '{}');\n          const cartId = (_user$cart2 = user.cart) === null || _user$cart2 === void 0 ? void 0 : _user$cart2.cartId;\n          if (cartId) {\n            const cart = await cartService.getCart(emailId, cartId);\n            const count = cartService.getTotalItems(cart.products || []);\n            return count;\n          }\n        } catch (serverError) {\n          console.warn('‚ö†Ô∏è Kh√¥ng th·ªÉ l·∫•y cart count t·ª´ server:', serverError.message);\n        }\n      }\n      return 0;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi l·∫•y s·ªë l∆∞·ª£ng gi·ªè h√†ng:', error);\n      return cartService.getCartCountFromStorage();\n    }\n  },\n  // ========== LOCAL STORAGE MANAGEMENT ==========\n\n  getCartFromStorage: () => {\n    try {\n      return JSON.parse(localStorage.getItem('cart') || 'null');\n    } catch (error) {\n      return null;\n    }\n  },\n  getCartCountFromStorage: () => {\n    try {\n      const cart = JSON.parse(localStorage.getItem('cart') || '{}');\n      return cartService.getTotalItems(cart.products || []);\n    } catch (error) {\n      return 0;\n    }\n  },\n  updateCartInStorage: cart => {\n    try {\n      localStorage.setItem('cart', JSON.stringify(cart));\n\n      // Trigger event ƒë·ªÉ c·∫≠p nh·∫≠t UI components kh√°c\n      window.dispatchEvent(new Event('cartUpdated'));\n    } catch (error) {\n      console.error('Error updating cart in storage:', error);\n    }\n  },\n  clearCartFromStorage: () => {\n    try {\n      localStorage.removeItem('cart');\n      window.dispatchEvent(new Event('cartUpdated'));\n    } catch (error) {\n      console.error('Error clearing cart from storage:', error);\n    }\n  },\n  // ========== CART ID MANAGEMENT ==========\n\n  // L·∫•y ho·∫∑c t·∫°o cartId\n  getOrCreateCartId: async emailId => {\n    try {\n      var _user$cart3;\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n      let cartId = (_user$cart3 = user.cart) === null || _user$cart3 === void 0 ? void 0 : _user$cart3.cartId;\n      if (cartId) {\n        return cartId;\n      }\n      const newCart = await cartService.createCart(emailId);\n      return newCart.cartId;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi l·∫•y/t·∫°o cartId:', error);\n      throw error;\n    }\n  },\n  // Ki·ªÉm tra s·∫£n ph·∫©m c√≥ trong gi·ªè h√†ng kh√¥ng\n  isProductInCart: (cart, productId) => {\n    if (!cart || !cart.products) return false;\n    return cart.products.some(item => item.productId === productId);\n  }\n};\nexport default cartService;","map":{"version":3,"names":["api","cartService","createCart","emailId","console","log","response","post","data","newCart","user","JSON","parse","localStorage","getItem","cart","cartId","setItem","stringify","updateCartInStorage","error","Error","getActiveCart","_user$cart","products","totalPrice","getCart","serverError","_serverError$response","warn","message","status","addToCart","productId","quantity","numericCartId","Number","isNaN","_error$response","_error$response2","_error$response$data","get","updateQuantity","put","removeFromCart","delete","email","updatedCart","clearCart","length","success","deletePromises","map","product","Promise","all","emptyCart","createOrder","paymentMethod","_error$response3","_error$response4","_error$response5","errorMessage","_error$response$data2","calculateTotal","cartItems","reduce","total","item","price","specialPrice","undefined","getTotalItems","formatPrice","toLocaleString","style","currency","getCartCount","localCount","getCartCountFromStorage","_user$cart2","count","getCartFromStorage","window","dispatchEvent","Event","clearCartFromStorage","removeItem","getOrCreateCartId","_user$cart3","isProductInCart","some"],"sources":["D:/JVA/frontend/src/services/cartService.js"],"sourcesContent":["import api from './api';\n\nconst cartService = {\n  // ========== CART CREATION & MANAGEMENT ==========\n\n  // T·∫°o gi·ªè h√†ng m·ªõi - ƒê√É C√ì ENDPOINT\ncreateCart: async (emailId) => {\n  try {\n    console.log(\"üÜï ƒêang t·∫°o gi·ªè h√†ng m·ªõi cho:\", emailId);\n    \n    // ‚ùå REMOVE: Kh√¥ng t·∫°o cart t·∫°m trong localStorage n·ªØa\n    // ‚úÖ CH·ªà g·ªçi API ƒë·ªÉ server t·∫°o cart\n    \n    const response = await api.post(`/public/users/${emailId}/carts`);\n    console.log(\"‚úÖ ƒê√£ t·∫°o gi·ªè h√†ng t·ª´ server:\", response.data);\n    \n    const newCart = response.data;\n    \n    // C·∫≠p nh·∫≠t user trong localStorage v·ªõi cartId t·ª´ SERVER\n    const user = JSON.parse(localStorage.getItem('user') || '{}');\n    user.cart = { cartId: newCart.cartId };\n    localStorage.setItem('user', JSON.stringify(user));\n    \n    // C·∫≠p nh·∫≠t cart trong localStorage\n    cartService.updateCartInStorage(newCart);\n    \n    return newCart;\n  } catch (error) {\n    console.error('‚ùå L·ªói khi t·∫°o gi·ªè h√†ng:', error);\n    \n    // ‚ùå KH√îNG t·∫°o cart t·∫°m - s·∫Ω g√¢y l·ªói 404\n    throw new Error('Kh√¥ng th·ªÉ t·∫°o gi·ªè h√†ng. Vui l√≤ng th·ª≠ l·∫°i.');\n  }\n},\n\n// L·∫•y gi·ªè h√†ng active - FIX L·ªñI\ngetActiveCart: async (emailId) => {\n  try {\n    const user = JSON.parse(localStorage.getItem('user') || '{}');\n    let cartId = user.cart?.cartId;\n    \n    console.log(\"üîç T√¨m cartId:\", { emailId, cartId });\n\n    // Ki·ªÉm tra user ƒëƒÉng nh·∫≠p\n    if (!emailId || emailId === 'guest@example.com') {\n      console.log(\"üë§ User ch∆∞a ƒëƒÉng nh·∫≠p\");\n      return {\n        cartId: null,\n        products: [],\n        totalPrice: 0\n      };\n    }\n\n    // N·∫øu c√≥ cartId, th·ª≠ l·∫•y t·ª´ server\n    if (cartId) {\n      try {\n        console.log(\"üì¶ Th·ª≠ l·∫•y gi·ªè h√†ng t·ª´ server v·ªõi cartId:\", cartId);\n        const cart = await cartService.getCart(emailId, cartId);\n        console.log(\"‚úÖ L·∫•y gi·ªè h√†ng t·ª´ server th√†nh c√¥ng\");\n        return cart;\n      } catch (serverError) {\n        console.warn(\"‚ö†Ô∏è Kh√¥ng l·∫•y ƒë∆∞·ª£c cart t·ª´ server:\", serverError.message);\n        \n        // N·∫øu l·ªói 404, cart kh√¥ng t·ªìn t·∫°i -> t·∫°o m·ªõi\n        if (serverError.response?.status === 404) {\n          console.log(\"üÜï Cart kh√¥ng t·ªìn t·∫°i tr√™n server, ƒëang t·∫°o m·ªõi...\");\n          return await cartService.createCart(emailId);\n        }\n        throw serverError;\n      }\n    }\n\n    // N·∫øu kh√¥ng c√≥ cartId, t·∫°o m·ªõi\n    console.log(\"üÜï Ch∆∞a c√≥ cartId, ƒëang t·∫°o gi·ªè h√†ng m·ªõi...\");\n    return await cartService.createCart(emailId);\n\n  } catch (error) {\n    console.error('‚ùå L·ªói khi l·∫•y gi·ªè h√†ng active:', error);\n    throw error;\n  }\n},\n\n// Th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng - FIX L·ªñI\naddToCart: async (cartId, productId, quantity = 1) => {\n  try {\n    console.log(`üõí Th√™m s·∫£n ph·∫©m ${productId} (s·ªë l∆∞·ª£ng: ${quantity}) v√†o gi·ªè ${cartId}`);\n    \n    // ‚úÖ KI·ªÇM TRA cartId c√≥ h·ª£p l·ªá kh√¥ng\n    if (!cartId) {\n      throw new Error('CartId kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng');\n    }\n\n    // ‚úÖ ƒê·∫¢M B·∫¢O cartId l√† s·ªë v√† h·ª£p l·ªá\n    const numericCartId = Number(cartId);\n    if (isNaN(numericCartId) || numericCartId <= 0) {\n      throw new Error(`CartId kh√¥ng h·ª£p l·ªá: ${cartId}`);\n    }\n\n    console.log(`üîß G·ªçi API: /public/carts/${numericCartId}/products/${productId}/quantity/${quantity}`);\n    \n    const response = await api.post(`/public/carts/${numericCartId}/products/${productId}/quantity/${quantity}`);\n    console.log(\"‚úÖ Th√™m v√†o gi·ªè h√†ng th√†nh c√¥ng:\", response.data);\n    \n    return response.data;\n  } catch (error) {\n    console.error('‚ùå L·ªói khi th√™m v√†o gi·ªè h√†ng:', error);\n    \n    // ‚úÖ PH√ÇN T√çCH L·ªñI CHI TI·∫æT\n    if (error.response?.status === 404) {\n      throw new Error(`Kh√¥ng t√¨m th·∫•y gi·ªè h√†ng (ID: ${cartId}). Vui l√≤ng th·ª≠ l·∫°i.`);\n    } else if (error.response?.status === 400) {\n      throw new Error(`S·∫£n ph·∫©m kh√¥ng h·ª£p l·ªá ho·∫∑c ƒë√£ c√≥ trong gi·ªè h√†ng: ${error.response.data?.message || ''}`);\n    }\n    \n    throw error;\n  }\n},\n  // L·∫•y gi·ªè h√†ng theo email v√† cartId\n  getCart: async (emailId, cartId) => {\n    try {\n      const response = await api.get(`/public/users/${emailId}/carts/${cartId}`);\n      return response.data;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi l·∫•y gi·ªè h√†ng:', error);\n      throw error;\n    }\n  },\n\n  // Th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng\n  addToCart: async (cartId, productId, quantity = 1) => {\n    try {\n      console.log(`üõí Th√™m s·∫£n ph·∫©m ${productId} (s·ªë l∆∞·ª£ng: ${quantity}) v√†o gi·ªè ${cartId}`);\n      \n      if (!cartId) {\n        throw new Error('CartId kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng');\n      }\n\n      const response = await api.post(`/public/carts/${cartId}/products/${productId}/quantity/${quantity}`);\n      console.log(\"‚úÖ Th√™m v√†o gi·ªè h√†ng th√†nh c√¥ng:\", response.data);\n      \n      // C·∫≠p nh·∫≠t localStorage v·ªõi d·ªØ li·ªáu m·ªõi\n      cartService.updateCartInStorage(response.data);\n      \n      return response.data;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi th√™m v√†o gi·ªè h√†ng:', error);\n      throw error;\n    }\n  },\n\n  // C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng s·∫£n ph·∫©m\n  updateQuantity: async (cartId, productId, quantity) => {\n    try {\n      console.log(`üîÑ C·∫≠p nh·∫≠t s·∫£n ph·∫©m ${productId} th√†nh s·ªë l∆∞·ª£ng: ${quantity}`);\n      \n      if (!cartId) {\n        throw new Error('CartId kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng');\n      }\n\n      const response = await api.put(`/public/carts/${cartId}/products/${productId}/quantity/${quantity}`);\n      console.log(\"‚úÖ C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng th√†nh c√¥ng:\", response.data);\n      \n      // C·∫≠p nh·∫≠t localStorage\n      cartService.updateCartInStorage(response.data);\n      \n      return response.data;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi c·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng:', error);\n      throw error;\n    }\n  },\n\n  // X√≥a s·∫£n ph·∫©m kh·ªèi gi·ªè h√†ng\n  removeFromCart: async (cartId, productId) => {\n    try {\n      console.log(`üóëÔ∏è X√≥a s·∫£n ph·∫©m ${productId} kh·ªèi gi·ªè ${cartId}`);\n      \n      if (!cartId) {\n        throw new Error('CartId kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng');\n      }\n\n      const response = await api.delete(`/public/carts/${cartId}/products/${productId}`);\n      console.log(\"‚úÖ X√≥a s·∫£n ph·∫©m th√†nh c√¥ng:\", response.data);\n      \n      // C·∫ßn l·∫•y l·∫°i gi·ªè h√†ng sau khi x√≥a ƒë·ªÉ c√≥ d·ªØ li·ªáu m·ªõi nh·∫•t\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n      if (user.email) {\n        const updatedCart = await cartService.getCart(user.email, cartId);\n        cartService.updateCartInStorage(updatedCart);\n        return updatedCart;\n      }\n      \n      return response.data;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi x√≥a s·∫£n ph·∫©m:', error);\n      throw error;\n    }\n  },\n\n  // L√†m r·ªóng gi·ªè h√†ng (x√≥a t·∫•t c·∫£ s·∫£n ph·∫©m)\n  clearCart: async (emailId, cartId) => {\n    try {\n      console.log(`üßπ L√†m r·ªóng gi·ªè h√†ng ${cartId}`);\n      \n      if (!cartId) {\n        throw new Error('CartId kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ tr·ªëng');\n      }\n\n      // L·∫•y danh s√°ch s·∫£n ph·∫©m trong gi·ªè\n      const cart = await cartService.getCart(emailId, cartId);\n      \n      if (!cart.products || cart.products.length === 0) {\n        return { success: true, message: 'Gi·ªè h√†ng ƒë√£ tr·ªëng' };\n      }\n      \n      // X√≥a t·ª´ng s·∫£n ph·∫©m\n      const deletePromises = cart.products.map(product => \n        cartService.removeFromCart(cartId, product.productId)\n      );\n      \n      await Promise.all(deletePromises);\n      \n      console.log('‚úÖ ƒê√£ l√†m r·ªóng gi·ªè h√†ng th√†nh c√¥ng');\n      \n      // C·∫≠p nh·∫≠t localStorage v·ªõi gi·ªè h√†ng r·ªóng\n      const emptyCart = {\n        cartId: cartId,\n        products: [],\n        totalPrice: 0\n      };\n      cartService.updateCartInStorage(emptyCart);\n      \n      return { success: true, message: 'ƒê√£ l√†m r·ªóng gi·ªè h√†ng' };\n    } catch (error) {\n      console.error('‚ùå L·ªói khi l√†m r·ªóng gi·ªè h√†ng:', error);\n      throw error;\n    }\n  },\n\n  // ========== ORDER MANAGEMENT ==========\n\n  // T·∫°o ƒë∆°n h√†ng\n  createOrder: async (emailId, cartId, paymentMethod) => {\n    try {\n      console.log('üõí T·∫°o ƒë∆°n h√†ng v·ªõi:', { \n        emailId, \n        cartId, \n        paymentMethod\n      });\n\n      // Validate d·ªØ li·ªáu\n      if (!emailId || !cartId || !paymentMethod) {\n        throw new Error('Thi·∫øu th√¥ng tin b·∫Øt bu·ªôc: email, cartId, paymentMethod');\n      }\n\n      const response = await api.post(\n        `/public/users/${emailId}/carts/${cartId}/payments/${paymentMethod}/order`\n      );\n      \n      console.log('‚úÖ T·∫°o ƒë∆°n h√†ng th√†nh c√¥ng:', response.data);\n      \n      return response.data;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi t·∫°o ƒë∆°n h√†ng:', error);\n      \n      let errorMessage = 'L·ªói khi t·∫°o ƒë∆°n h√†ng';\n      \n      if (error.response?.status === 400) {\n        errorMessage = error.response.data?.message || 'D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá';\n      } else if (error.response?.status === 404) {\n        errorMessage = 'Kh√¥ng t√¨m th·∫•y gi·ªè h√†ng ho·∫∑c ng∆∞·ªùi d√πng';\n      } else if (error.response?.status === 500) {\n        errorMessage = 'L·ªói server, vui l√≤ng th·ª≠ l·∫°i sau';\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      \n      throw new Error(errorMessage);\n    }\n  },\n\n  // ========== UTILITY FUNCTIONS ==========\n\n  // T√≠nh t·ªïng ti·ªÅn gi·ªè h√†ng\n  calculateTotal: (cartItems) => {\n    if (!cartItems || cartItems.length === 0) return 0;\n    return cartItems.reduce((total, item) => {\n      const price = item.specialPrice !== undefined && item.specialPrice !== null \n        ? item.specialPrice \n        : item.price || 0;\n      const quantity = item.quantity || 1;\n      return total + (price * quantity);\n    }, 0);\n  },\n\n  // ƒê·∫øm t·ªïng s·ªë s·∫£n ph·∫©m\n  getTotalItems: (cartItems) => {\n    if (!cartItems || cartItems.length === 0) return 0;\n    return cartItems.reduce((total, item) => total + (item.quantity || 1), 0);\n  },\n\n  // Format gi√° ti·ªÅn\n  formatPrice: (price) => {\n    return (Number(price) || 0).toLocaleString('vi-VN', {\n      style: 'currency',\n      currency: 'VND'\n    });\n  },\n\n  // L·∫•y s·ªë l∆∞·ª£ng s·∫£n ph·∫©m trong gi·ªè (cho badge)\n  getCartCount: async (emailId) => {\n    try {\n      // ∆Øu ti√™n l·∫•y t·ª´ localStorage tr∆∞·ªõc (nhanh)\n      const localCount = cartService.getCartCountFromStorage();\n      if (localCount > 0) {\n        return localCount;\n      }\n\n      // N·∫øu c√≥ user ƒëƒÉng nh·∫≠p, th·ª≠ l·∫•y t·ª´ server\n      if (emailId && emailId !== 'guest@example.com') {\n        try {\n          const user = JSON.parse(localStorage.getItem('user') || '{}');\n          const cartId = user.cart?.cartId;\n          \n          if (cartId) {\n            const cart = await cartService.getCart(emailId, cartId);\n            const count = cartService.getTotalItems(cart.products || []);\n            return count;\n          }\n        } catch (serverError) {\n          console.warn('‚ö†Ô∏è Kh√¥ng th·ªÉ l·∫•y cart count t·ª´ server:', serverError.message);\n        }\n      }\n      \n      return 0;\n    } catch (error) {\n      console.error('‚ùå L·ªói khi l·∫•y s·ªë l∆∞·ª£ng gi·ªè h√†ng:', error);\n      return cartService.getCartCountFromStorage();\n    }\n  },\n\n  // ========== LOCAL STORAGE MANAGEMENT ==========\n\n  getCartFromStorage: () => {\n    try {\n      return JSON.parse(localStorage.getItem('cart') || 'null');\n    } catch (error) {\n      return null;\n    }\n  },\n\n  getCartCountFromStorage: () => {\n    try {\n      const cart = JSON.parse(localStorage.getItem('cart') || '{}');\n      return cartService.getTotalItems(cart.products || []);\n    } catch (error) {\n      return 0;\n    }\n  },\n\n  updateCartInStorage: (cart) => {\n    try {\n      localStorage.setItem('cart', JSON.stringify(cart));\n      \n      // Trigger event ƒë·ªÉ c·∫≠p nh·∫≠t UI components kh√°c\n      window.dispatchEvent(new Event('cartUpdated'));\n    } catch (error) {\n      console.error('Error updating cart in storage:', error);\n    }\n  },\n\n  clearCartFromStorage: () => {\n    try {\n      localStorage.removeItem('cart');\n      window.dispatchEvent(new Event('cartUpdated'));\n    } catch (error) {\n      console.error('Error clearing cart from storage:', error);\n    }\n  },\n\n  // ========== CART ID MANAGEMENT ==========\n\n  // L·∫•y ho·∫∑c t·∫°o cartId\n  getOrCreateCartId: async (emailId) => {\n    try {\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n      let cartId = user.cart?.cartId;\n      \n      if (cartId) {\n        return cartId;\n      }\n      \n      const newCart = await cartService.createCart(emailId);\n      return newCart.cartId;\n      \n    } catch (error) {\n      console.error('‚ùå L·ªói khi l·∫•y/t·∫°o cartId:', error);\n      throw error;\n    }\n  },\n\n  // Ki·ªÉm tra s·∫£n ph·∫©m c√≥ trong gi·ªè h√†ng kh√¥ng\n  isProductInCart: (cart, productId) => {\n    if (!cart || !cart.products) return false;\n    return cart.products.some(item => item.productId === productId);\n  }\n};\n\nexport default cartService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}