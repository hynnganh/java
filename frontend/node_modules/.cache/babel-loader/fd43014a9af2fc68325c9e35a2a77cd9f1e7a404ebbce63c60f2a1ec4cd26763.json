{"ast":null,"code":"// services/cartService.js\nimport api from './api';\nconst cartService = {\n  // ========== ADMIN ENDPOINTS ==========\n\n  // Láº¥y táº¥t cáº£ giá» hÃ ng (Admin)\n  getAllCarts: async () => {\n    try {\n      const response = await api.get('/admin/carts');\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y danh sÃ¡ch giá» hÃ ng:', error);\n      throw error;\n    }\n  },\n  // ========== PUBLIC ENDPOINTS ==========\n\n  // Láº¥y giá» hÃ ng theo user vÃ  cartId\n  getCart: async (emailId, cartId) => {\n    try {\n      const response = await api.get(`/public/users/${emailId}/carts/${cartId}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y giá» hÃ ng:', error);\n      throw error;\n    }\n  },\n  // ThÃªm sáº£n pháº©m vÃ o giá» hÃ ng\n  addToCart: async (cartId, productId, quantity) => {\n    try {\n      const response = await api.post(`/public/carts/${cartId}/products/${productId}/quantity/${quantity}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi thÃªm vÃ o giá» hÃ ng:', error);\n      throw error;\n    }\n  },\n  // Cáº­p nháº­t sá»‘ lÆ°á»£ng sáº£n pháº©m\n  updateQuantity: async (cartId, productId, quantity) => {\n    try {\n      const response = await api.put(`/public/carts/${cartId}/products/${productId}/quantity/${quantity}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi cáº­p nháº­t sá»‘ lÆ°á»£ng:', error);\n      throw error;\n    }\n  },\n  // XÃ³a sáº£n pháº©m khá»i giá» hÃ ng\n  removeFromCart: async (cartId, productId) => {\n    try {\n      const response = await api.delete(`/public/carts/${cartId}/products/${productId}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi xÃ³a sáº£n pháº©m:', error);\n      throw error;\n    }\n  },\n  // ========== CART MANAGEMENT ==========\n\n  // Láº¥y giá» hÃ ng active - ÄÃƒ Sá»¬A: Chá»‰ sá»­ dá»¥ng cartId sá»‘\n  getActiveCart: async emailId => {\n    try {\n      var _user$cart;\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n      let cartId = (_user$cart = user.cart) === null || _user$cart === void 0 ? void 0 : _user$cart.cartId;\n      console.log(\"ðŸ” TÃ¬m cartId:\", {\n        emailId,\n        cartId\n      });\n\n      // Náº¿u khÃ´ng cÃ³ cartId, thá»­ tÃ¬m trong cart localStorage\n      if (!cartId) {\n        const localCart = cartService.getCartFromStorage();\n        if (localCart && localCart.cartId) {\n          cartId = localCart.cartId;\n          console.log(\"ðŸ”„ Sá»­ dá»¥ng cartId tá»« localStorage:\", cartId);\n        }\n      }\n\n      // Náº¿u váº«n khÃ´ng cÃ³ cartId, táº¡o giá» hÃ ng má»›i\n      if (!cartId) {\n        console.log(\"ðŸ†• ChÆ°a cÃ³ giá» hÃ ng, Ä‘ang táº¡o giá» hÃ ng má»›i...\");\n        const newCart = await cartService.createCart(emailId);\n        cartId = newCart.cartId;\n        console.log(\"âœ… ÄÃ£ táº¡o giá» hÃ ng má»›i vá»›i cartId:\", cartId);\n      }\n\n      // Äáº£m báº£o cartId lÃ  sá»‘ trÆ°á»›c khi gá»i API\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}. Pháº£i lÃ  sá»‘.`);\n      }\n\n      // Láº¥y giá» hÃ ng tá»« server\n      console.log(\"ðŸ“¦ Láº¥y giá» hÃ ng tá»« server vá»›i cartId:\", numericCartId);\n      const cart = await cartService.getCart(emailId, numericCartId);\n\n      // Cáº­p nháº­t localStorage\n      cartService.updateCartInStorage(cart);\n      return cart;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y giá» hÃ ng active:', error);\n\n      // Fallback: tráº£ vá» cart tá»« localStorage\n      const localCart = cartService.getCartFromStorage();\n      if (localCart) {\n        console.log(\"ðŸ”„ Fallback: sá»­ dá»¥ng cart tá»« localStorage\");\n        return localCart;\n      }\n\n      // Náº¿u váº«n lá»—i, tráº£ vá» giá» hÃ ng rá»—ng vá»›i cartId null\n      console.log(\"ðŸ”„ Tráº£ vá» giá» hÃ ng rá»—ng\");\n      return {\n        cartId: null,\n        products: [],\n        totalPrice: 0\n      };\n    }\n  },\n  // Táº¡o giá» hÃ ng má»›i - ÄÃƒ Sá»¬A: Chá»‰ tráº£ vá» cartId sá»‘\n  createCart: async emailId => {\n    try {\n      console.log(\"ðŸ†• Äang táº¡o giá» hÃ ng má»›i cho:\", emailId);\n\n      // Gá»i API táº¡o giá» hÃ ng\n      const response = await api.post(`/public/users/${emailId}/carts`);\n      console.log(\"âœ… ÄÃ£ táº¡o giá» hÃ ng:\", response.data);\n      const newCart = response.data;\n\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      if (newCart.cartId && typeof newCart.cartId !== 'number') {\n        newCart.cartId = Number(newCart.cartId);\n      }\n\n      // Cáº­p nháº­t user trong localStorage vá»›i cartId má»›i\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n      user.cart = {\n        cartId: newCart.cartId\n      };\n      localStorage.setItem('user', JSON.stringify(user));\n\n      // Cáº­p nháº­t cart trong localStorage\n      cartService.updateCartInStorage(newCart);\n      return newCart;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi táº¡o giá» hÃ ng:', error);\n\n      // KHÃ”NG táº¡o giá» hÃ ng local fallback ná»¯a\n      // VÃ¬ backend cáº§n cartId sá»‘, khÃ´ng thá»ƒ dÃ¹ng string\n      throw new Error('KhÃ´ng thá»ƒ táº¡o giá» hÃ ng. Vui lÃ²ng thá»­ láº¡i sau.');\n    }\n  },\n  // CÃ¡c hÃ m API khÃ¡c - ÄÃƒ Sá»¬A: Äáº£m báº£o cartId lÃ  sá»‘\n  getCart: async (emailId, cartId) => {\n    try {\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}`);\n      }\n      const response = await api.get(`/public/users/${emailId}/carts/${numericCartId}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y giá» hÃ ng:', error);\n      throw error;\n    }\n  },\n  addToCart: async (cartId, productId, quantity) => {\n    try {\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}`);\n      }\n      const response = await api.post(`/public/carts/${numericCartId}/products/${productId}/quantity/${quantity}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi thÃªm vÃ o giá» hÃ ng:', error);\n      throw error;\n    }\n  },\n  updateQuantity: async (cartId, productId, quantity) => {\n    try {\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}`);\n      }\n      const response = await api.put(`/public/carts/${numericCartId}/products/${productId}/quantity/${quantity}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi cáº­p nháº­t sá»‘ lÆ°á»£ng:', error);\n      throw error;\n    }\n  },\n  removeFromCart: async (cartId, productId) => {\n    try {\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}`);\n      }\n      const response = await api.delete(`/public/carts/${numericCartId}/products/${productId}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi xÃ³a sáº£n pháº©m:', error);\n      throw error;\n    }\n  },\n  clearCart: async (emailId, cartId) => {\n    try {\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}`);\n      }\n      console.log('ðŸ§¹ Clearing cart:', {\n        emailId,\n        cartId: numericCartId\n      });\n\n      // Láº¥y giá» hÃ ng hiá»‡n táº¡i\n      const cart = await cartService.getCart(emailId, numericCartId);\n      if (!cart || !cart.products || cart.products.length === 0) {\n        return {\n          success: true,\n          message: 'Giá» hÃ ng Ä‘Ã£ trá»‘ng'\n        };\n      }\n\n      // XÃ³a tá»«ng sáº£n pháº©m\n      const deletePromises = cart.products.map(product => cartService.removeFromCart(numericCartId, product.productId));\n      await Promise.all(deletePromises);\n      console.log('âœ… ÄÃ£ xÃ³a táº¥t cáº£ sáº£n pháº©m khá»i giá» hÃ ng');\n      return {\n        success: true,\n        message: 'ÄÃ£ lÃ m rá»—ng giá» hÃ ng'\n      };\n    } catch (error) {\n      console.error('âŒ Lá»—i khi lÃ m rá»—ng giá» hÃ ng:', error);\n      throw error;\n    }\n  },\n  createOrder: async (emailId, cartId, paymentMethod) => {\n    try {\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}`);\n      }\n      console.log('ðŸ›’ Creating order with:', {\n        emailId,\n        cartId: numericCartId,\n        paymentMethod\n      });\n      const response = await api.post(`/public/users/${emailId}/carts/${numericCartId}/payments/${paymentMethod}/order`);\n      console.log('âœ… Order created successfully:', response.data);\n      return response.data;\n    } catch (error) {\n      var _error$response, _error$response2;\n      console.error('âŒ Order creation failed:', error);\n      console.error('Error details:', {\n        status: (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status,\n        data: (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data,\n        message: error.message\n      });\n      throw error;\n    }\n  },\n  // ========== UTILITIES ==========\n\n  // TÃ­nh tá»•ng tiá»n giá» hÃ ng\n  calculateTotal: cartItems => {\n    if (!cartItems || cartItems.length === 0) return 0;\n    return cartItems.reduce((total, item) => {\n      const price = item.specialPrice !== undefined && item.specialPrice !== null ? item.specialPrice : item.price || 0;\n      const quantity = item.quantity || 1;\n      return total + price * quantity;\n    }, 0);\n  },\n  // Äáº¿m tá»•ng sá»‘ sáº£n pháº©m trong giá»\n  getTotalItems: cartItems => {\n    if (!cartItems || cartItems.length === 0) return 0;\n    return cartItems.reduce((total, item) => total + (item.quantity || 1), 0);\n  },\n  // Láº¥y sá»‘ lÆ°á»£ng sáº£n pháº©m trong giá» hÃ ng - ÄÃƒ Sá»¬A\n  getCartCount: async emailId => {\n    try {\n      // Æ¯u tiÃªn láº¥y tá»« localStorage trÆ°á»›c\n      const localCount = cartService.getCartCountFromStorage();\n      if (localCount > 0) {\n        return localCount;\n      }\n\n      // Náº¿u cÃ³ user, thá»­ láº¥y tá»« server\n      if (emailId && emailId !== 'guest@example.com') {\n        try {\n          var _user$cart2;\n          const user = JSON.parse(localStorage.getItem('user') || '{}');\n          let cartId = (_user$cart2 = user.cart) === null || _user$cart2 === void 0 ? void 0 : _user$cart2.cartId;\n\n          // Náº¿u khÃ´ng cÃ³ cartId, khÃ´ng gá»i API\n          if (!cartId) {\n            console.warn('âš ï¸ KhÃ´ng cÃ³ cartId, khÃ´ng thá»ƒ láº¥y cart tá»« server');\n            return 0;\n          }\n          const cart = await cartService.getCart(emailId, cartId);\n          if (cart && cart.products) {\n            // Cáº­p nháº­t localStorage\n            cartService.updateCartInStorage(cart);\n            return cartService.getTotalItems(cart.products);\n          }\n        } catch (serverError) {\n          console.warn('âš ï¸ KhÃ´ng thá»ƒ láº¥y cart tá»« server:', serverError.message);\n          // Tiáº¿p tá»¥c vá»›i localStorage\n        }\n      }\n      return 0;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y sá»‘ lÆ°á»£ng giá» hÃ ng:', error);\n      return cartService.getCartCountFromStorage();\n    }\n  },\n  // ========== LOCAL STORAGE MANAGEMENT ==========\n\n  // Láº¥y giá» hÃ ng tá»« localStorage\n  getCartFromStorage: () => {\n    try {\n      const cart = JSON.parse(localStorage.getItem('cart') || 'null');\n      return cart;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y cart tá»« localStorage:', error);\n      return null;\n    }\n  },\n  // Láº¥y sá»‘ lÆ°á»£ng tá»« localStorage (nhanh)\n  getCartCountFromStorage: () => {\n    try {\n      const cart = JSON.parse(localStorage.getItem('cart') || '{}');\n      return cartService.getTotalItems(cart.products || []);\n    } catch (error) {\n      return 0;\n    }\n  },\n  // Cáº­p nháº­t giá» hÃ ng trong localStorage\n  updateCartInStorage: cart => {\n    try {\n      localStorage.setItem('cart', JSON.stringify(cart));\n    } catch (error) {\n      console.error('Error updating cart in storage:', error);\n    }\n  },\n  // XÃ³a giá» hÃ ng khá»i localStorage\n  clearCartFromStorage: () => {\n    try {\n      localStorage.removeItem('cart');\n    } catch (error) {\n      console.error('Error clearing cart from storage:', error);\n    }\n  },\n  // ========== CART ID MANAGEMENT ==========\n\n  // Láº¥y hoáº·c táº¡o cartId - HÃ€M QUAN TRá»ŒNG\n  getOrCreateCartId: async emailId => {\n    try {\n      var _user$cart3;\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n      let cartId = (_user$cart3 = user.cart) === null || _user$cart3 === void 0 ? void 0 : _user$cart3.cartId;\n\n      // Náº¿u Ä‘Ã£ cÃ³ cartId, tráº£ vá»\n      if (cartId) {\n        console.log(\"âœ… ÄÃ£ cÃ³ cartId:\", cartId);\n        return cartId;\n      }\n\n      // Náº¿u khÃ´ng cÃ³ cartId, táº¡o giá» hÃ ng má»›i\n      console.log(\"ðŸ†• ChÆ°a cÃ³ cartId, Ä‘ang táº¡o giá» hÃ ng má»›i...\");\n      const newCart = await cartService.createCart(emailId);\n      cartId = newCart.cartId;\n\n      // Cáº­p nháº­t user trong localStorage\n      user.cart = {\n        cartId: cartId\n      };\n      localStorage.setItem('user', JSON.stringify(user));\n      console.log(\"âœ… ÄÃ£ táº¡o cartId má»›i:\", cartId);\n      return cartId;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y/táº¡o cartId:', error);\n      throw error;\n    }\n  },\n  // Kiá»ƒm tra sáº£n pháº©m cÃ³ trong giá» hÃ ng khÃ´ng\n  isProductInCart: (cart, productId) => {\n    if (!cart || !cart.products) return false;\n    return cart.products.some(item => item.productId === productId);\n  },\n  // Láº¥y thÃ´ng tin sáº£n pháº©m trong giá»\n  getCartItem: (cart, productId) => {\n    if (!cart || !cart.products) return null;\n    return cart.products.find(item => item.productId === productId);\n  },\n  // Format price hiá»ƒn thá»‹\n  formatPrice: price => {\n    return (Number(price) || 0).toLocaleString('vi-VN', {\n      style: 'currency',\n      currency: 'VND'\n    });\n  }\n};\nexport default cartService;","map":{"version":3,"names":["api","cartService","getAllCarts","response","get","data","error","console","getCart","emailId","cartId","addToCart","productId","quantity","post","updateQuantity","put","removeFromCart","delete","getActiveCart","_user$cart","user","JSON","parse","localStorage","getItem","cart","log","localCart","getCartFromStorage","newCart","createCart","numericCartId","Number","isNaN","Error","updateCartInStorage","products","totalPrice","setItem","stringify","clearCart","length","success","message","deletePromises","map","product","Promise","all","createOrder","paymentMethod","_error$response","_error$response2","status","calculateTotal","cartItems","reduce","total","item","price","specialPrice","undefined","getTotalItems","getCartCount","localCount","getCartCountFromStorage","_user$cart2","warn","serverError","clearCartFromStorage","removeItem","getOrCreateCartId","_user$cart3","isProductInCart","some","getCartItem","find","formatPrice","toLocaleString","style","currency"],"sources":["D:/JVA/frontend/src/services/cartService.js"],"sourcesContent":["// services/cartService.js\nimport api from './api';\n\nconst cartService = {\n  // ========== ADMIN ENDPOINTS ==========\n  \n  // Láº¥y táº¥t cáº£ giá» hÃ ng (Admin)\n  getAllCarts: async () => {\n    try {\n      const response = await api.get('/admin/carts');\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y danh sÃ¡ch giá» hÃ ng:', error);\n      throw error;\n    }\n  },\n\n  // ========== PUBLIC ENDPOINTS ==========\n\n  // Láº¥y giá» hÃ ng theo user vÃ  cartId\n  getCart: async (emailId, cartId) => {\n    try {\n      const response = await api.get(`/public/users/${emailId}/carts/${cartId}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y giá» hÃ ng:', error);\n      throw error;\n    }\n  },\n\n  // ThÃªm sáº£n pháº©m vÃ o giá» hÃ ng\n  addToCart: async (cartId, productId, quantity) => {\n    try {\n      const response = await api.post(`/public/carts/${cartId}/products/${productId}/quantity/${quantity}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi thÃªm vÃ o giá» hÃ ng:', error);\n      throw error;\n    }\n  },\n\n  // Cáº­p nháº­t sá»‘ lÆ°á»£ng sáº£n pháº©m\n  updateQuantity: async (cartId, productId, quantity) => {\n    try {\n      const response = await api.put(`/public/carts/${cartId}/products/${productId}/quantity/${quantity}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi cáº­p nháº­t sá»‘ lÆ°á»£ng:', error);\n      throw error;\n    }\n  },\n\n  // XÃ³a sáº£n pháº©m khá»i giá» hÃ ng\n  removeFromCart: async (cartId, productId) => {\n    try {\n      const response = await api.delete(`/public/carts/${cartId}/products/${productId}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi xÃ³a sáº£n pháº©m:', error);\n      throw error;\n    }\n  },\n\n  // ========== CART MANAGEMENT ==========\n\n  // Láº¥y giá» hÃ ng active - ÄÃƒ Sá»¬A: Chá»‰ sá»­ dá»¥ng cartId sá»‘\n  getActiveCart: async (emailId) => {\n    try {\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n      let cartId = user.cart?.cartId;\n      \n      console.log(\"ðŸ” TÃ¬m cartId:\", { emailId, cartId });\n\n      // Náº¿u khÃ´ng cÃ³ cartId, thá»­ tÃ¬m trong cart localStorage\n      if (!cartId) {\n        const localCart = cartService.getCartFromStorage();\n        if (localCart && localCart.cartId) {\n          cartId = localCart.cartId;\n          console.log(\"ðŸ”„ Sá»­ dá»¥ng cartId tá»« localStorage:\", cartId);\n        }\n      }\n      \n      // Náº¿u váº«n khÃ´ng cÃ³ cartId, táº¡o giá» hÃ ng má»›i\n      if (!cartId) {\n        console.log(\"ðŸ†• ChÆ°a cÃ³ giá» hÃ ng, Ä‘ang táº¡o giá» hÃ ng má»›i...\");\n        const newCart = await cartService.createCart(emailId);\n        cartId = newCart.cartId;\n        console.log(\"âœ… ÄÃ£ táº¡o giá» hÃ ng má»›i vá»›i cartId:\", cartId);\n      }\n      \n      // Äáº£m báº£o cartId lÃ  sá»‘ trÆ°á»›c khi gá»i API\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}. Pháº£i lÃ  sá»‘.`);\n      }\n      \n      // Láº¥y giá» hÃ ng tá»« server\n      console.log(\"ðŸ“¦ Láº¥y giá» hÃ ng tá»« server vá»›i cartId:\", numericCartId);\n      const cart = await cartService.getCart(emailId, numericCartId);\n      \n      // Cáº­p nháº­t localStorage\n      cartService.updateCartInStorage(cart);\n      \n      return cart;\n      \n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y giá» hÃ ng active:', error);\n      \n      // Fallback: tráº£ vá» cart tá»« localStorage\n      const localCart = cartService.getCartFromStorage();\n      if (localCart) {\n        console.log(\"ðŸ”„ Fallback: sá»­ dá»¥ng cart tá»« localStorage\");\n        return localCart;\n      }\n      \n      // Náº¿u váº«n lá»—i, tráº£ vá» giá» hÃ ng rá»—ng vá»›i cartId null\n      console.log(\"ðŸ”„ Tráº£ vá» giá» hÃ ng rá»—ng\");\n      return {\n        cartId: null,\n        products: [],\n        totalPrice: 0\n      };\n    }\n  },\n\n  // Táº¡o giá» hÃ ng má»›i - ÄÃƒ Sá»¬A: Chá»‰ tráº£ vá» cartId sá»‘\n  createCart: async (emailId) => {\n    try {\n      console.log(\"ðŸ†• Äang táº¡o giá» hÃ ng má»›i cho:\", emailId);\n      \n      // Gá»i API táº¡o giá» hÃ ng\n      const response = await api.post(`/public/users/${emailId}/carts`);\n      console.log(\"âœ… ÄÃ£ táº¡o giá» hÃ ng:\", response.data);\n      \n      const newCart = response.data;\n      \n      // Äáº£m báº£o cartId lÃ  sá»‘\n      if (newCart.cartId && typeof newCart.cartId !== 'number') {\n        newCart.cartId = Number(newCart.cartId);\n      }\n      \n      // Cáº­p nháº­t user trong localStorage vá»›i cartId má»›i\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n      user.cart = { cartId: newCart.cartId };\n      localStorage.setItem('user', JSON.stringify(user));\n      \n      // Cáº­p nháº­t cart trong localStorage\n      cartService.updateCartInStorage(newCart);\n      \n      return newCart;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi táº¡o giá» hÃ ng:', error);\n      \n      // KHÃ”NG táº¡o giá» hÃ ng local fallback ná»¯a\n      // VÃ¬ backend cáº§n cartId sá»‘, khÃ´ng thá»ƒ dÃ¹ng string\n      throw new Error('KhÃ´ng thá»ƒ táº¡o giá» hÃ ng. Vui lÃ²ng thá»­ láº¡i sau.');\n    }\n  },\n\n  // CÃ¡c hÃ m API khÃ¡c - ÄÃƒ Sá»¬A: Äáº£m báº£o cartId lÃ  sá»‘\n  getCart: async (emailId, cartId) => {\n    try {\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}`);\n      }\n      \n      const response = await api.get(`/public/users/${emailId}/carts/${numericCartId}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y giá» hÃ ng:', error);\n      throw error;\n    }\n  },\n\n  addToCart: async (cartId, productId, quantity) => {\n    try {\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}`);\n      }\n      \n      const response = await api.post(`/public/carts/${numericCartId}/products/${productId}/quantity/${quantity}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi thÃªm vÃ o giá» hÃ ng:', error);\n      throw error;\n    }\n  },\n\n  updateQuantity: async (cartId, productId, quantity) => {\n    try {\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}`);\n      }\n      \n      const response = await api.put(`/public/carts/${numericCartId}/products/${productId}/quantity/${quantity}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi cáº­p nháº­t sá»‘ lÆ°á»£ng:', error);\n      throw error;\n    }\n  },\n\n  removeFromCart: async (cartId, productId) => {\n    try {\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}`);\n      }\n      \n      const response = await api.delete(`/public/carts/${numericCartId}/products/${productId}`);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi xÃ³a sáº£n pháº©m:', error);\n      throw error;\n    }\n  },\n\n  clearCart: async (emailId, cartId) => {\n    try {\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}`);\n      }\n      \n      console.log('ðŸ§¹ Clearing cart:', { emailId, cartId: numericCartId });\n      \n      // Láº¥y giá» hÃ ng hiá»‡n táº¡i\n      const cart = await cartService.getCart(emailId, numericCartId);\n      \n      if (!cart || !cart.products || cart.products.length === 0) {\n        return { success: true, message: 'Giá» hÃ ng Ä‘Ã£ trá»‘ng' };\n      }\n      \n      // XÃ³a tá»«ng sáº£n pháº©m\n      const deletePromises = cart.products.map(product => \n        cartService.removeFromCart(numericCartId, product.productId)\n      );\n      \n      await Promise.all(deletePromises);\n      \n      console.log('âœ… ÄÃ£ xÃ³a táº¥t cáº£ sáº£n pháº©m khá»i giá» hÃ ng');\n      return { success: true, message: 'ÄÃ£ lÃ m rá»—ng giá» hÃ ng' };\n    } catch (error) {\n      console.error('âŒ Lá»—i khi lÃ m rá»—ng giá» hÃ ng:', error);\n      throw error;\n    }\n  },\n\n  createOrder: async (emailId, cartId, paymentMethod) => {\n    try {\n      // Äáº£m báº£o cartId lÃ  sá»‘\n      const numericCartId = Number(cartId);\n      if (isNaN(numericCartId)) {\n        throw new Error(`CartId khÃ´ng há»£p lá»‡: ${cartId}`);\n      }\n      \n      console.log('ðŸ›’ Creating order with:', { emailId, cartId: numericCartId, paymentMethod });\n      \n      const response = await api.post(\n        `/public/users/${emailId}/carts/${numericCartId}/payments/${paymentMethod}/order`\n      );\n      \n      console.log('âœ… Order created successfully:', response.data);\n      return response.data;\n    } catch (error) {\n      console.error('âŒ Order creation failed:', error);\n      console.error('Error details:', {\n        status: error.response?.status,\n        data: error.response?.data,\n        message: error.message\n      });\n      throw error;\n    }\n  },\n\n  // ========== UTILITIES ==========\n\n  // TÃ­nh tá»•ng tiá»n giá» hÃ ng\n  calculateTotal: (cartItems) => {\n    if (!cartItems || cartItems.length === 0) return 0;\n    \n    return cartItems.reduce((total, item) => {\n      const price = item.specialPrice !== undefined && item.specialPrice !== null \n        ? item.specialPrice \n        : item.price || 0;\n      const quantity = item.quantity || 1;\n      return total + (price * quantity);\n    }, 0);\n  },\n\n  // Äáº¿m tá»•ng sá»‘ sáº£n pháº©m trong giá»\n  getTotalItems: (cartItems) => {\n    if (!cartItems || cartItems.length === 0) return 0;\n    return cartItems.reduce((total, item) => total + (item.quantity || 1), 0);\n  },\n\n  // Láº¥y sá»‘ lÆ°á»£ng sáº£n pháº©m trong giá» hÃ ng - ÄÃƒ Sá»¬A\n  getCartCount: async (emailId) => {\n    try {\n      // Æ¯u tiÃªn láº¥y tá»« localStorage trÆ°á»›c\n      const localCount = cartService.getCartCountFromStorage();\n      if (localCount > 0) {\n        return localCount;\n      }\n\n      // Náº¿u cÃ³ user, thá»­ láº¥y tá»« server\n      if (emailId && emailId !== 'guest@example.com') {\n        try {\n          const user = JSON.parse(localStorage.getItem('user') || '{}');\n          let cartId = user.cart?.cartId;\n          \n          // Náº¿u khÃ´ng cÃ³ cartId, khÃ´ng gá»i API\n          if (!cartId) {\n            console.warn('âš ï¸ KhÃ´ng cÃ³ cartId, khÃ´ng thá»ƒ láº¥y cart tá»« server');\n            return 0;\n          }\n          \n          const cart = await cartService.getCart(emailId, cartId);\n          if (cart && cart.products) {\n            // Cáº­p nháº­t localStorage\n            cartService.updateCartInStorage(cart);\n            return cartService.getTotalItems(cart.products);\n          }\n        } catch (serverError) {\n          console.warn('âš ï¸ KhÃ´ng thá»ƒ láº¥y cart tá»« server:', serverError.message);\n          // Tiáº¿p tá»¥c vá»›i localStorage\n        }\n      }\n      \n      return 0;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y sá»‘ lÆ°á»£ng giá» hÃ ng:', error);\n      return cartService.getCartCountFromStorage();\n    }\n  },\n\n  // ========== LOCAL STORAGE MANAGEMENT ==========\n\n  // Láº¥y giá» hÃ ng tá»« localStorage\n  getCartFromStorage: () => {\n    try {\n      const cart = JSON.parse(localStorage.getItem('cart') || 'null');\n      return cart;\n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y cart tá»« localStorage:', error);\n      return null;\n    }\n  },\n\n  // Láº¥y sá»‘ lÆ°á»£ng tá»« localStorage (nhanh)\n  getCartCountFromStorage: () => {\n    try {\n      const cart = JSON.parse(localStorage.getItem('cart') || '{}');\n      return cartService.getTotalItems(cart.products || []);\n    } catch (error) {\n      return 0;\n    }\n  },\n\n  // Cáº­p nháº­t giá» hÃ ng trong localStorage\n  updateCartInStorage: (cart) => {\n    try {\n      localStorage.setItem('cart', JSON.stringify(cart));\n    } catch (error) {\n      console.error('Error updating cart in storage:', error);\n    }\n  },\n\n  // XÃ³a giá» hÃ ng khá»i localStorage\n  clearCartFromStorage: () => {\n    try {\n      localStorage.removeItem('cart');\n    } catch (error) {\n      console.error('Error clearing cart from storage:', error);\n    }\n  },\n\n  // ========== CART ID MANAGEMENT ==========\n\n  // Láº¥y hoáº·c táº¡o cartId - HÃ€M QUAN TRá»ŒNG\n  getOrCreateCartId: async (emailId) => {\n    try {\n      const user = JSON.parse(localStorage.getItem('user') || '{}');\n      let cartId = user.cart?.cartId;\n      \n      // Náº¿u Ä‘Ã£ cÃ³ cartId, tráº£ vá»\n      if (cartId) {\n        console.log(\"âœ… ÄÃ£ cÃ³ cartId:\", cartId);\n        return cartId;\n      }\n      \n      // Náº¿u khÃ´ng cÃ³ cartId, táº¡o giá» hÃ ng má»›i\n      console.log(\"ðŸ†• ChÆ°a cÃ³ cartId, Ä‘ang táº¡o giá» hÃ ng má»›i...\");\n      const newCart = await cartService.createCart(emailId);\n      cartId = newCart.cartId;\n      \n      // Cáº­p nháº­t user trong localStorage\n      user.cart = { cartId: cartId };\n      localStorage.setItem('user', JSON.stringify(user));\n      \n      console.log(\"âœ… ÄÃ£ táº¡o cartId má»›i:\", cartId);\n      return cartId;\n      \n    } catch (error) {\n      console.error('âŒ Lá»—i khi láº¥y/táº¡o cartId:', error);\n      throw error;\n    }\n  },\n\n  // Kiá»ƒm tra sáº£n pháº©m cÃ³ trong giá» hÃ ng khÃ´ng\n  isProductInCart: (cart, productId) => {\n    if (!cart || !cart.products) return false;\n    return cart.products.some(item => item.productId === productId);\n  },\n\n  // Láº¥y thÃ´ng tin sáº£n pháº©m trong giá»\n  getCartItem: (cart, productId) => {\n    if (!cart || !cart.products) return null;\n    return cart.products.find(item => item.productId === productId);\n  },\n\n  // Format price hiá»ƒn thá»‹\n  formatPrice: (price) => {\n    return (Number(price) || 0).toLocaleString('vi-VN', {\n      style: 'currency',\n      currency: 'VND'\n    });\n  }\n};\n\nexport default cartService;"],"mappings":"AAAA;AACA,OAAOA,GAAG,MAAM,OAAO;AAEvB,MAAMC,WAAW,GAAG;EAClB;;EAEA;EACAC,WAAW,EAAE,MAAAA,CAAA,KAAY;IACvB,IAAI;MACF,MAAMC,QAAQ,GAAG,MAAMH,GAAG,CAACI,GAAG,CAAC,cAAc,CAAC;MAC9C,OAAOD,QAAQ,CAACE,IAAI;IACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;MACzD,MAAMA,KAAK;IACb;EACF,CAAC;EAED;;EAEA;EACAE,OAAO,EAAE,MAAAA,CAAOC,OAAO,EAAEC,MAAM,KAAK;IAClC,IAAI;MACF,MAAMP,QAAQ,GAAG,MAAMH,GAAG,CAACI,GAAG,CAAC,iBAAiBK,OAAO,UAAUC,MAAM,EAAE,CAAC;MAC1E,OAAOP,QAAQ,CAACE,IAAI;IACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/C,MAAMA,KAAK;IACb;EACF,CAAC;EAED;EACAK,SAAS,EAAE,MAAAA,CAAOD,MAAM,EAAEE,SAAS,EAAEC,QAAQ,KAAK;IAChD,IAAI;MACF,MAAMV,QAAQ,GAAG,MAAMH,GAAG,CAACc,IAAI,CAAC,iBAAiBJ,MAAM,aAAaE,SAAS,aAAaC,QAAQ,EAAE,CAAC;MACrG,OAAOV,QAAQ,CAACE,IAAI;IACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;MACpD,MAAMA,KAAK;IACb;EACF,CAAC;EAED;EACAS,cAAc,EAAE,MAAAA,CAAOL,MAAM,EAAEE,SAAS,EAAEC,QAAQ,KAAK;IACrD,IAAI;MACF,MAAMV,QAAQ,GAAG,MAAMH,GAAG,CAACgB,GAAG,CAAC,iBAAiBN,MAAM,aAAaE,SAAS,aAAaC,QAAQ,EAAE,CAAC;MACpG,OAAOV,QAAQ,CAACE,IAAI;IACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;MACpD,MAAMA,KAAK;IACb;EACF,CAAC;EAED;EACAW,cAAc,EAAE,MAAAA,CAAOP,MAAM,EAAEE,SAAS,KAAK;IAC3C,IAAI;MACF,MAAMT,QAAQ,GAAG,MAAMH,GAAG,CAACkB,MAAM,CAAC,iBAAiBR,MAAM,aAAaE,SAAS,EAAE,CAAC;MAClF,OAAOT,QAAQ,CAACE,IAAI;IACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/C,MAAMA,KAAK;IACb;EACF,CAAC;EAED;;EAEA;EACAa,aAAa,EAAE,MAAOV,OAAO,IAAK;IAChC,IAAI;MAAA,IAAAW,UAAA;MACF,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC;MAC7D,IAAIf,MAAM,IAAAU,UAAA,GAAGC,IAAI,CAACK,IAAI,cAAAN,UAAA,uBAATA,UAAA,CAAWV,MAAM;MAE9BH,OAAO,CAACoB,GAAG,CAAC,gBAAgB,EAAE;QAAElB,OAAO;QAAEC;MAAO,CAAC,CAAC;;MAElD;MACA,IAAI,CAACA,MAAM,EAAE;QACX,MAAMkB,SAAS,GAAG3B,WAAW,CAAC4B,kBAAkB,CAAC,CAAC;QAClD,IAAID,SAAS,IAAIA,SAAS,CAAClB,MAAM,EAAE;UACjCA,MAAM,GAAGkB,SAAS,CAAClB,MAAM;UACzBH,OAAO,CAACoB,GAAG,CAAC,oCAAoC,EAAEjB,MAAM,CAAC;QAC3D;MACF;;MAEA;MACA,IAAI,CAACA,MAAM,EAAE;QACXH,OAAO,CAACoB,GAAG,CAAC,+CAA+C,CAAC;QAC5D,MAAMG,OAAO,GAAG,MAAM7B,WAAW,CAAC8B,UAAU,CAACtB,OAAO,CAAC;QACrDC,MAAM,GAAGoB,OAAO,CAACpB,MAAM;QACvBH,OAAO,CAACoB,GAAG,CAAC,mCAAmC,EAAEjB,MAAM,CAAC;MAC1D;;MAEA;MACA,MAAMsB,aAAa,GAAGC,MAAM,CAACvB,MAAM,CAAC;MACpC,IAAIwB,KAAK,CAACF,aAAa,CAAC,EAAE;QACxB,MAAM,IAAIG,KAAK,CAAC,wBAAwBzB,MAAM,eAAe,CAAC;MAChE;;MAEA;MACAH,OAAO,CAACoB,GAAG,CAAC,uCAAuC,EAAEK,aAAa,CAAC;MACnE,MAAMN,IAAI,GAAG,MAAMzB,WAAW,CAACO,OAAO,CAACC,OAAO,EAAEuB,aAAa,CAAC;;MAE9D;MACA/B,WAAW,CAACmC,mBAAmB,CAACV,IAAI,CAAC;MAErC,OAAOA,IAAI;IAEb,CAAC,CAAC,OAAOpB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;;MAEtD;MACA,MAAMsB,SAAS,GAAG3B,WAAW,CAAC4B,kBAAkB,CAAC,CAAC;MAClD,IAAID,SAAS,EAAE;QACbrB,OAAO,CAACoB,GAAG,CAAC,2CAA2C,CAAC;QACxD,OAAOC,SAAS;MAClB;;MAEA;MACArB,OAAO,CAACoB,GAAG,CAAC,yBAAyB,CAAC;MACtC,OAAO;QACLjB,MAAM,EAAE,IAAI;QACZ2B,QAAQ,EAAE,EAAE;QACZC,UAAU,EAAE;MACd,CAAC;IACH;EACF,CAAC;EAED;EACAP,UAAU,EAAE,MAAOtB,OAAO,IAAK;IAC7B,IAAI;MACFF,OAAO,CAACoB,GAAG,CAAC,+BAA+B,EAAElB,OAAO,CAAC;;MAErD;MACA,MAAMN,QAAQ,GAAG,MAAMH,GAAG,CAACc,IAAI,CAAC,iBAAiBL,OAAO,QAAQ,CAAC;MACjEF,OAAO,CAACoB,GAAG,CAAC,oBAAoB,EAAExB,QAAQ,CAACE,IAAI,CAAC;MAEhD,MAAMyB,OAAO,GAAG3B,QAAQ,CAACE,IAAI;;MAE7B;MACA,IAAIyB,OAAO,CAACpB,MAAM,IAAI,OAAOoB,OAAO,CAACpB,MAAM,KAAK,QAAQ,EAAE;QACxDoB,OAAO,CAACpB,MAAM,GAAGuB,MAAM,CAACH,OAAO,CAACpB,MAAM,CAAC;MACzC;;MAEA;MACA,MAAMW,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC;MAC7DJ,IAAI,CAACK,IAAI,GAAG;QAAEhB,MAAM,EAAEoB,OAAO,CAACpB;MAAO,CAAC;MACtCc,YAAY,CAACe,OAAO,CAAC,MAAM,EAAEjB,IAAI,CAACkB,SAAS,CAACnB,IAAI,CAAC,CAAC;;MAElD;MACApB,WAAW,CAACmC,mBAAmB,CAACN,OAAO,CAAC;MAExC,OAAOA,OAAO;IAChB,CAAC,CAAC,OAAOxB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;;MAE/C;MACA;MACA,MAAM,IAAI6B,KAAK,CAAC,+CAA+C,CAAC;IAClE;EACF,CAAC;EAED;EACA3B,OAAO,EAAE,MAAAA,CAAOC,OAAO,EAAEC,MAAM,KAAK;IAClC,IAAI;MACF;MACA,MAAMsB,aAAa,GAAGC,MAAM,CAACvB,MAAM,CAAC;MACpC,IAAIwB,KAAK,CAACF,aAAa,CAAC,EAAE;QACxB,MAAM,IAAIG,KAAK,CAAC,wBAAwBzB,MAAM,EAAE,CAAC;MACnD;MAEA,MAAMP,QAAQ,GAAG,MAAMH,GAAG,CAACI,GAAG,CAAC,iBAAiBK,OAAO,UAAUuB,aAAa,EAAE,CAAC;MACjF,OAAO7B,QAAQ,CAACE,IAAI;IACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/C,MAAMA,KAAK;IACb;EACF,CAAC;EAEDK,SAAS,EAAE,MAAAA,CAAOD,MAAM,EAAEE,SAAS,EAAEC,QAAQ,KAAK;IAChD,IAAI;MACF;MACA,MAAMmB,aAAa,GAAGC,MAAM,CAACvB,MAAM,CAAC;MACpC,IAAIwB,KAAK,CAACF,aAAa,CAAC,EAAE;QACxB,MAAM,IAAIG,KAAK,CAAC,wBAAwBzB,MAAM,EAAE,CAAC;MACnD;MAEA,MAAMP,QAAQ,GAAG,MAAMH,GAAG,CAACc,IAAI,CAAC,iBAAiBkB,aAAa,aAAapB,SAAS,aAAaC,QAAQ,EAAE,CAAC;MAC5G,OAAOV,QAAQ,CAACE,IAAI;IACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;MACpD,MAAMA,KAAK;IACb;EACF,CAAC;EAEDS,cAAc,EAAE,MAAAA,CAAOL,MAAM,EAAEE,SAAS,EAAEC,QAAQ,KAAK;IACrD,IAAI;MACF;MACA,MAAMmB,aAAa,GAAGC,MAAM,CAACvB,MAAM,CAAC;MACpC,IAAIwB,KAAK,CAACF,aAAa,CAAC,EAAE;QACxB,MAAM,IAAIG,KAAK,CAAC,wBAAwBzB,MAAM,EAAE,CAAC;MACnD;MAEA,MAAMP,QAAQ,GAAG,MAAMH,GAAG,CAACgB,GAAG,CAAC,iBAAiBgB,aAAa,aAAapB,SAAS,aAAaC,QAAQ,EAAE,CAAC;MAC3G,OAAOV,QAAQ,CAACE,IAAI;IACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;MACpD,MAAMA,KAAK;IACb;EACF,CAAC;EAEDW,cAAc,EAAE,MAAAA,CAAOP,MAAM,EAAEE,SAAS,KAAK;IAC3C,IAAI;MACF;MACA,MAAMoB,aAAa,GAAGC,MAAM,CAACvB,MAAM,CAAC;MACpC,IAAIwB,KAAK,CAACF,aAAa,CAAC,EAAE;QACxB,MAAM,IAAIG,KAAK,CAAC,wBAAwBzB,MAAM,EAAE,CAAC;MACnD;MAEA,MAAMP,QAAQ,GAAG,MAAMH,GAAG,CAACkB,MAAM,CAAC,iBAAiBc,aAAa,aAAapB,SAAS,EAAE,CAAC;MACzF,OAAOT,QAAQ,CAACE,IAAI;IACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,EAAEA,KAAK,CAAC;MAC/C,MAAMA,KAAK;IACb;EACF,CAAC;EAEDmC,SAAS,EAAE,MAAAA,CAAOhC,OAAO,EAAEC,MAAM,KAAK;IACpC,IAAI;MACF;MACA,MAAMsB,aAAa,GAAGC,MAAM,CAACvB,MAAM,CAAC;MACpC,IAAIwB,KAAK,CAACF,aAAa,CAAC,EAAE;QACxB,MAAM,IAAIG,KAAK,CAAC,wBAAwBzB,MAAM,EAAE,CAAC;MACnD;MAEAH,OAAO,CAACoB,GAAG,CAAC,mBAAmB,EAAE;QAAElB,OAAO;QAAEC,MAAM,EAAEsB;MAAc,CAAC,CAAC;;MAEpE;MACA,MAAMN,IAAI,GAAG,MAAMzB,WAAW,CAACO,OAAO,CAACC,OAAO,EAAEuB,aAAa,CAAC;MAE9D,IAAI,CAACN,IAAI,IAAI,CAACA,IAAI,CAACW,QAAQ,IAAIX,IAAI,CAACW,QAAQ,CAACK,MAAM,KAAK,CAAC,EAAE;QACzD,OAAO;UAAEC,OAAO,EAAE,IAAI;UAAEC,OAAO,EAAE;QAAoB,CAAC;MACxD;;MAEA;MACA,MAAMC,cAAc,GAAGnB,IAAI,CAACW,QAAQ,CAACS,GAAG,CAACC,OAAO,IAC9C9C,WAAW,CAACgB,cAAc,CAACe,aAAa,EAAEe,OAAO,CAACnC,SAAS,CAC7D,CAAC;MAED,MAAMoC,OAAO,CAACC,GAAG,CAACJ,cAAc,CAAC;MAEjCtC,OAAO,CAACoB,GAAG,CAAC,wCAAwC,CAAC;MACrD,OAAO;QAAEgB,OAAO,EAAE,IAAI;QAAEC,OAAO,EAAE;MAAuB,CAAC;IAC3D,CAAC,CAAC,OAAOtC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;MACpD,MAAMA,KAAK;IACb;EACF,CAAC;EAED4C,WAAW,EAAE,MAAAA,CAAOzC,OAAO,EAAEC,MAAM,EAAEyC,aAAa,KAAK;IACrD,IAAI;MACF;MACA,MAAMnB,aAAa,GAAGC,MAAM,CAACvB,MAAM,CAAC;MACpC,IAAIwB,KAAK,CAACF,aAAa,CAAC,EAAE;QACxB,MAAM,IAAIG,KAAK,CAAC,wBAAwBzB,MAAM,EAAE,CAAC;MACnD;MAEAH,OAAO,CAACoB,GAAG,CAAC,yBAAyB,EAAE;QAAElB,OAAO;QAAEC,MAAM,EAAEsB,aAAa;QAAEmB;MAAc,CAAC,CAAC;MAEzF,MAAMhD,QAAQ,GAAG,MAAMH,GAAG,CAACc,IAAI,CAC7B,iBAAiBL,OAAO,UAAUuB,aAAa,aAAamB,aAAa,QAC3E,CAAC;MAED5C,OAAO,CAACoB,GAAG,CAAC,+BAA+B,EAAExB,QAAQ,CAACE,IAAI,CAAC;MAC3D,OAAOF,QAAQ,CAACE,IAAI;IACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;MAAA,IAAA8C,eAAA,EAAAC,gBAAA;MACd9C,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MAChDC,OAAO,CAACD,KAAK,CAAC,gBAAgB,EAAE;QAC9BgD,MAAM,GAAAF,eAAA,GAAE9C,KAAK,CAACH,QAAQ,cAAAiD,eAAA,uBAAdA,eAAA,CAAgBE,MAAM;QAC9BjD,IAAI,GAAAgD,gBAAA,GAAE/C,KAAK,CAACH,QAAQ,cAAAkD,gBAAA,uBAAdA,gBAAA,CAAgBhD,IAAI;QAC1BuC,OAAO,EAAEtC,KAAK,CAACsC;MACjB,CAAC,CAAC;MACF,MAAMtC,KAAK;IACb;EACF,CAAC;EAED;;EAEA;EACAiD,cAAc,EAAGC,SAAS,IAAK;IAC7B,IAAI,CAACA,SAAS,IAAIA,SAAS,CAACd,MAAM,KAAK,CAAC,EAAE,OAAO,CAAC;IAElD,OAAOc,SAAS,CAACC,MAAM,CAAC,CAACC,KAAK,EAAEC,IAAI,KAAK;MACvC,MAAMC,KAAK,GAAGD,IAAI,CAACE,YAAY,KAAKC,SAAS,IAAIH,IAAI,CAACE,YAAY,KAAK,IAAI,GACvEF,IAAI,CAACE,YAAY,GACjBF,IAAI,CAACC,KAAK,IAAI,CAAC;MACnB,MAAM/C,QAAQ,GAAG8C,IAAI,CAAC9C,QAAQ,IAAI,CAAC;MACnC,OAAO6C,KAAK,GAAIE,KAAK,GAAG/C,QAAS;IACnC,CAAC,EAAE,CAAC,CAAC;EACP,CAAC;EAED;EACAkD,aAAa,EAAGP,SAAS,IAAK;IAC5B,IAAI,CAACA,SAAS,IAAIA,SAAS,CAACd,MAAM,KAAK,CAAC,EAAE,OAAO,CAAC;IAClD,OAAOc,SAAS,CAACC,MAAM,CAAC,CAACC,KAAK,EAAEC,IAAI,KAAKD,KAAK,IAAIC,IAAI,CAAC9C,QAAQ,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC;EAC3E,CAAC;EAED;EACAmD,YAAY,EAAE,MAAOvD,OAAO,IAAK;IAC/B,IAAI;MACF;MACA,MAAMwD,UAAU,GAAGhE,WAAW,CAACiE,uBAAuB,CAAC,CAAC;MACxD,IAAID,UAAU,GAAG,CAAC,EAAE;QAClB,OAAOA,UAAU;MACnB;;MAEA;MACA,IAAIxD,OAAO,IAAIA,OAAO,KAAK,mBAAmB,EAAE;QAC9C,IAAI;UAAA,IAAA0D,WAAA;UACF,MAAM9C,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC;UAC7D,IAAIf,MAAM,IAAAyD,WAAA,GAAG9C,IAAI,CAACK,IAAI,cAAAyC,WAAA,uBAATA,WAAA,CAAWzD,MAAM;;UAE9B;UACA,IAAI,CAACA,MAAM,EAAE;YACXH,OAAO,CAAC6D,IAAI,CAAC,kDAAkD,CAAC;YAChE,OAAO,CAAC;UACV;UAEA,MAAM1C,IAAI,GAAG,MAAMzB,WAAW,CAACO,OAAO,CAACC,OAAO,EAAEC,MAAM,CAAC;UACvD,IAAIgB,IAAI,IAAIA,IAAI,CAACW,QAAQ,EAAE;YACzB;YACApC,WAAW,CAACmC,mBAAmB,CAACV,IAAI,CAAC;YACrC,OAAOzB,WAAW,CAAC8D,aAAa,CAACrC,IAAI,CAACW,QAAQ,CAAC;UACjD;QACF,CAAC,CAAC,OAAOgC,WAAW,EAAE;UACpB9D,OAAO,CAAC6D,IAAI,CAAC,kCAAkC,EAAEC,WAAW,CAACzB,OAAO,CAAC;UACrE;QACF;MACF;MAEA,OAAO,CAAC;IACV,CAAC,CAAC,OAAOtC,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;MACxD,OAAOL,WAAW,CAACiE,uBAAuB,CAAC,CAAC;IAC9C;EACF,CAAC;EAED;;EAEA;EACArC,kBAAkB,EAAEA,CAAA,KAAM;IACxB,IAAI;MACF,MAAMH,IAAI,GAAGJ,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,IAAI,MAAM,CAAC;MAC/D,OAAOC,IAAI;IACb,CAAC,CAAC,OAAOpB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,qCAAqC,EAAEA,KAAK,CAAC;MAC3D,OAAO,IAAI;IACb;EACF,CAAC;EAED;EACA4D,uBAAuB,EAAEA,CAAA,KAAM;IAC7B,IAAI;MACF,MAAMxC,IAAI,GAAGJ,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC;MAC7D,OAAOxB,WAAW,CAAC8D,aAAa,CAACrC,IAAI,CAACW,QAAQ,IAAI,EAAE,CAAC;IACvD,CAAC,CAAC,OAAO/B,KAAK,EAAE;MACd,OAAO,CAAC;IACV;EACF,CAAC;EAED;EACA8B,mBAAmB,EAAGV,IAAI,IAAK;IAC7B,IAAI;MACFF,YAAY,CAACe,OAAO,CAAC,MAAM,EAAEjB,IAAI,CAACkB,SAAS,CAACd,IAAI,CAAC,CAAC;IACpD,CAAC,CAAC,OAAOpB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;IACzD;EACF,CAAC;EAED;EACAgE,oBAAoB,EAAEA,CAAA,KAAM;IAC1B,IAAI;MACF9C,YAAY,CAAC+C,UAAU,CAAC,MAAM,CAAC;IACjC,CAAC,CAAC,OAAOjE,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;IAC3D;EACF,CAAC;EAED;;EAEA;EACAkE,iBAAiB,EAAE,MAAO/D,OAAO,IAAK;IACpC,IAAI;MAAA,IAAAgE,WAAA;MACF,MAAMpD,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC;MAC7D,IAAIf,MAAM,IAAA+D,WAAA,GAAGpD,IAAI,CAACK,IAAI,cAAA+C,WAAA,uBAATA,WAAA,CAAW/D,MAAM;;MAE9B;MACA,IAAIA,MAAM,EAAE;QACVH,OAAO,CAACoB,GAAG,CAAC,iBAAiB,EAAEjB,MAAM,CAAC;QACtC,OAAOA,MAAM;MACf;;MAEA;MACAH,OAAO,CAACoB,GAAG,CAAC,6CAA6C,CAAC;MAC1D,MAAMG,OAAO,GAAG,MAAM7B,WAAW,CAAC8B,UAAU,CAACtB,OAAO,CAAC;MACrDC,MAAM,GAAGoB,OAAO,CAACpB,MAAM;;MAEvB;MACAW,IAAI,CAACK,IAAI,GAAG;QAAEhB,MAAM,EAAEA;MAAO,CAAC;MAC9Bc,YAAY,CAACe,OAAO,CAAC,MAAM,EAAEjB,IAAI,CAACkB,SAAS,CAACnB,IAAI,CAAC,CAAC;MAElDd,OAAO,CAACoB,GAAG,CAAC,sBAAsB,EAAEjB,MAAM,CAAC;MAC3C,OAAOA,MAAM;IAEf,CAAC,CAAC,OAAOJ,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;MACjD,MAAMA,KAAK;IACb;EACF,CAAC;EAED;EACAoE,eAAe,EAAEA,CAAChD,IAAI,EAAEd,SAAS,KAAK;IACpC,IAAI,CAACc,IAAI,IAAI,CAACA,IAAI,CAACW,QAAQ,EAAE,OAAO,KAAK;IACzC,OAAOX,IAAI,CAACW,QAAQ,CAACsC,IAAI,CAAChB,IAAI,IAAIA,IAAI,CAAC/C,SAAS,KAAKA,SAAS,CAAC;EACjE,CAAC;EAED;EACAgE,WAAW,EAAEA,CAAClD,IAAI,EAAEd,SAAS,KAAK;IAChC,IAAI,CAACc,IAAI,IAAI,CAACA,IAAI,CAACW,QAAQ,EAAE,OAAO,IAAI;IACxC,OAAOX,IAAI,CAACW,QAAQ,CAACwC,IAAI,CAAClB,IAAI,IAAIA,IAAI,CAAC/C,SAAS,KAAKA,SAAS,CAAC;EACjE,CAAC;EAED;EACAkE,WAAW,EAAGlB,KAAK,IAAK;IACtB,OAAO,CAAC3B,MAAM,CAAC2B,KAAK,CAAC,IAAI,CAAC,EAAEmB,cAAc,CAAC,OAAO,EAAE;MAClDC,KAAK,EAAE,UAAU;MACjBC,QAAQ,EAAE;IACZ,CAAC,CAAC;EACJ;AACF,CAAC;AAED,eAAehF,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}